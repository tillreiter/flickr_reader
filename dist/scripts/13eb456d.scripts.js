"use strict";angular.module("flickrReaderApp",["ngResource","ngRoute","ui.router","ngSanitize","angular-loading-bar","ngAnimate","anim-in-out"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.when("","/flickr/list"),b.otherwise("/flickr/list"),a.state("flickr",{"abstract":!0,url:"/flickr",templateUrl:"./views/flickr.html",controller:"flickrContentCtrl",resolve:{dataService:"dataService",topics:["dataService",function(a){return a.getData().then(function(a){return a},function(a){console.log(a)})}]}}).state("flickr.list",{url:"/list",templateUrl:"./views/flickr.list.html",onEnter:function(){console.log("enter state flickr.list")}}).state("flickr.detail",{url:"/:id",templateUrl:"./views/flickr.detail.html",resolve:{data:["topics",function(a){return a.data}]},controller:["$scope","$stateParams","$state","data",function(a,b,c,d){a.item=d.items[b.id],a.item||c.go("flickr.list")}],onEnter:["$location","$anchorScroll",function(a,b){console.log("enter state flickr.detail"),a.hash("top"),b()}]})}]),angular.module("flickrReaderApp").service("dataService",["$http",function(a){this.getData=function(){return a({method:"JSONP",url:"http://api.flickr.com/services/feeds/photos_public.gne?tags=potato&tagmode=all&format=json&jsoncallback=JSON_CALLBACK",withCredentials:!0,headers:{"Content-Type":"application/javascript"}})}}]).controller("flickrContentCtrl",["$scope","topics",function(a,b){a.topics=b.data}]),angular.module("flickrReaderApp").directive("flickrImageWithLinkToDetails",function(){return{restrict:"E",template:'<a ui-sref="flickr.detail({ id: $index})"><img ng-src="{{ item.media.m }}"></a>',link:function(a,b){$(b).imagefill()}}}).directive("photoTitle",function(){return{restrict:"A",controller:["$scope",function(a){a.item&&""===a.item.title&&(a.item.title="Unnamed")}],template:"{{ item.title }}"}}).directive("authorNameWithLinkToFlickr",function(){return{restrict:"E",controller:["$scope",function(a){var b=/\((.*)\)/;a.authorName=b.exec(a.item.author)[1]}],template:'<a ng-href="https://www.flickr.com/photos/{{ item.author_id }}"> <u> {{ authorName }}</u></a>'}}).directive("publicationDate",function(){return{restrict:"E",controller:["$scope",function(a){var b=a.item.published;a.publicationDate=moment(b).format("Do MMM YYYY [at] HH[:]mm")}],template:"<span>Published: {{ publicationDate }}</span>"}}).directive("viewOnFlickr",function(){return{restrict:"E",template:'<a ng-href="{{ item.link }}"><u> View on Flickr </u></a>'}}).directive("tagWithLink",function(){return{restrict:"E",controller:["$scope",function(a){a.tags=a.item.tags.split(" ")}],template:'<span ng-repeat="tag in tags"><a ng-href="https://www.flickr.com/photos/tags/{{ tag }}"><u>{{ tag }}</u></a></span>'}});